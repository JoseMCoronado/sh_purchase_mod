<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <data>
    <!--modification to Purchase Order form view-->
    <record model="ir.ui.view" id="purchase_order_form_mod">
      <field name="name">x_gfp.purchase.order.form.mod</field>
      <field name="model">purchase.order</field>
      <field name="inherit_id" ref="purchase.purchase_order_form"/>
      <field name="priority">99</field>
      <field name="arch" type="xml">
        <xpath expr="//button[@name='action_view_picking']" position="attributes">
          <attribute name="name">action_view_avl_picking</attribute>
        </xpath>
        <xpath expr="//field[@name='order_line']//tree//field[@name='date_planned']" position="attributes">
          <attribute name="widget">date</attribute>
        </xpath>
        <xpath expr="//field[@name='order_line']//tree//field[@name='taxes_id']" position="attributes">
          <attribute name="invisible">1</attribute>
        </xpath>
        <xpath expr="//field[@name='order_line']//tree//field[@name='price_subtotal']" position="after">
          <button name="button_scrap" type="object" icon="fa-recycle"/>
          <button name="%(action_purchase_line_return_picking)d"  type="action" icon="fa-chevron-circle-left"/>
        </xpath>
        <xpath expr="//button[@name='button_done']" position="attributes">
          <attribute name="invisible">1</attribute>
        </xpath>
      </field>
    </record>
    <record model="ir.ui.view" id="purchase_stock_picking_tree">
      <field name="name">x_gfp.purchase.stock.picking.tree</field>
      <field name="model">stock.picking</field>
      <field name="type">tree</field>
      <field name="inherit_id" eval="False"/>
      <field name="priority">16</field>
      <field name="arch" type="xml">
        <tree decoration-info="state == 'draft'" decoration-muted="state == 'cancel'" decoration-danger="state not in ('cancel', 'done') and min_date &lt; current_date" string="Picking list">
          <field name="transfer_type"/>
          <field name="name" invisible="1"/>
          <field name="location_dest_id"/>
          <field name="partner_id"/>
          <field name="date_done" string="Received Date"/>
          <field name="date" invisible="1"/>
          <field name="min_date"/>
          <field name="origin"/>
          <field name="group_id" invisible="1"/>
          <field name="backorder_id"/>
          <field name="state"/>
          <field name="priority" invisible="1"/>
          <field name="picking_type_id" invisible="1"/>
        </tree>
      </field>
    </record>
    <record model="ir.actions.act_window" id="action_purchase_picking_tree">
            <field name="name">Transfers</field>
            <field name="res_model">stock.picking</field>
            <field name="type">ir.actions.act_window</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,kanban,form,calendar</field>
            <field name="domain"></field>
            <field name="context">{
                    'search_default_picking_type_id': [active_id],
                    'default_picking_type_id': active_id,
                    'contact_display': 'partner_address',
            }
            </field>
            <field name="search_view_id" ref="stock.view_picking_internal_search"/>
            <field name="view_id" ref="sh_purchase_mod.purchase_stock_picking_tree"/>
    </record>
    <record model="ir.ui.view" id="view_picking_form_mod">
      <field name="name">x_gfp.stock.picking.form.mod</field>
      <field name="model">stock.picking</field>
      <field name="inherit_id" ref="stock.view_picking_form"/>
      <field name="priority">99</field>
      <field name="arch" type="xml">
        <xpath expr="//field[@name='backorder_id']" position="after">
          <field name="dest_address_id" attrs="{'invisible': [('dest_address_id','=',False)]}"/>
        </xpath>
      </field>
    </record>
    <record model="ir.ui.view" id="invoice_supplier_form_mod">
      <field name="name">x_gfp.account.invoice.supplier.form.mod</field>
      <field name="model">account.invoice</field>
      <field name="inherit_id" ref="account.invoice_supplier_form"/>
      <field name="priority">99</field>
      <field name="arch" type="xml">
        <xpath expr="//field[@name='invoice_line_ids']//tree//field[@name='quantity']" position="after">
          <field name="qty_received"/>
        </xpath>
      </field>
    </record>
    <record model="ir.ui.view" id="purchase_order_tree_mod">
      <field name="name">x_gfp.purchase.order.form.mod</field>
      <field name="model">purchase.order</field>
      <field name="inherit_id" ref="purchase.purchase_order_tree"/>
      <field name="priority">99</field>
      <field name="arch" type="xml">
        <xpath expr="//field[@name='state']" position="before">
          <field name="stage"/>
        </xpath>
      </field>
    </record>
    <record model="ir.ui.view" id="view_make_procurment_wizard_mod">
      <field name="name">x_gfp.procurement.request.form.mod</field>
      <field name="model">make.procurement</field>
      <field name="inherit_id" ref="stock.view_make_procurment_wizard"/>
      <field name="priority">99</field>
      <field name="arch" type="xml">
        <xpath expr="//field[@name='product_tmpl_id']" position="after">
          <field name="suppliers" required="1" options="{'no_create': True, 'no_open': True}"/>
        </xpath>
      </field>
    </record>
    <record model="ir.ui.view" id="view_product_supplier_inherit_mod">
      <field name="name">x_gfp.product.template.supplier.form.inherit.mod</field>
      <field name="model">product.template</field>
      <field name="inherit_id" ref="purchase.view_product_supplier_inherit"/>
      <field name="priority">99</field>
      <field name="arch" type="xml">
        <xpath expr="//field[@name='seller_ids']" position="replace">
          <field name="seller_ids" context="{'default_product_tmpl_id': context.get('product_tmpl_id', active_id)}">
            <tree>
              <field name="name"/>
              <field name="product_code"/>
              <field name="min_qty"/>
              <field name="price"/>
              <field name="date_start"/>
              <field name="date_end"/>
              <button name="duplicate" type="object" string="Duplicate"/>
            </tree>
          </field>
        </xpath>
      </field>
    </record>
    <record model="ir.ui.view" id="product_template_search_view_mod">
      <field name="name">x_gfp.product.template.search.mod</field>
      <field name="model">product.template</field>
      <field name="inherit_id" ref="product.product_template_search_view"/>
      <field name="priority">99</field>
      <field name="arch" type="xml">
        <xpath expr="//field[@name='name']" position="replace">
          <field name="name" string="Product" filter_domain="['|','|','|',('default_code','ilike',self),('supplier_codes','ilike',self),('name','ilike',self),('barcode','ilike',self)]"/>
        </xpath>
      </field>
    </record>
  </data>
</odoo>
